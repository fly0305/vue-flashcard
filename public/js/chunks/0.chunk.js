(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{220:function(e,a,t){"use strict";t.r(a);var i=t(3),r=t.n(i),s=t(16),n=t(60),c=t(102);function o(e,a,t,i,r,s,n){try{var c=e[s](n),o=c.value}catch(e){return void t(e)}c.done?a(o):Promise.resolve(o).then(i,r)}var l={mixins:[n.a,c.a],props:{userData:Object},data:function(){return{video:{},canvas:{},hasCamera:!1,isEditing:null,cameraDialog:!1}},methods:{enableCamera:function(){var e=this;"mediaDevices"in navigator&&(this.cameraDialog=!this.cameraDialog,this.video=this.$refs.video,this.canvas=this.$refs.canvas,this.canvas.style.display="block",navigator.mediaDevices.getUserMedia({video:!0}).then((function(a){e.video.srcObject=a,e.video.play()})),setInterval((function(){var a=e.video.videoWidth,t=e.video.videoHeight;e.canvas.width=a,e.canvas.height=t;e.canvas.getContext("2d").drawImage(e.video,0,0,a,t)}),16))},disableCamera:function(){this.cameraDialog=!1,this.canvas.style.display="none",this.video.srcObject.getVideoTracks().forEach((function(e){return e.stop()}))},remove:function(){this.userData.image="",this.userData.image_file=null},save:function(){var e,a=this;return(e=r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.resetState(),e.prev=1,e.next=4,a.$store.dispatch("profile/changeAvatar",{id:a.userData.id,image:a.userData.image,image_file:a.userData.image_file});case 4:a.isEditing=!a.isEditing,a.success=!0,e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),Object(s.b)(e.t0)&&(a.errors=Object(s.b)(e.t0)),Object(s.a)(e.t0)&&(a.error=Object(s.a)(e.t0));case 12:a.loading=!1;case 13:case"end":return e.stop()}}),e,null,[[1,8]])})),function(){var a=this,t=arguments;return new Promise((function(i,r){var s=e.apply(a,t);function n(e){o(s,i,r,n,c,"next",e)}function c(e){o(s,i,r,n,c,"throw",e)}n(void 0)}))})()},capture:function(){this.userData.image="",this.userData.image_file=null,this.userData.image=this.canvas.toDataURL("image/png"),this.disableCamera()}},computed:{isDisable:function(){return this.loading||!this.isEditing}},mounted:function(){var e=this,a=!1;navigator.mediaDevices&&navigator.mediaDevices.getUserMedia&&navigator.mediaDevices.enumerateDevices().then((function(e){e.forEach((function(e){"videoinput"===e.kind&&(a=!0)}))})).then((function(){e.hasCamera=a,console.log("hasCamera: ",e.hasCamera)}))}},v=t(12),u=t(14),d=t.n(u),m=t(562),f=t(127),g=t(208),p=t(15),h=t(561),b=t(565),_=t(564),D=t(563),k=t(126),w=t(566),x=Object(v.a)(l,(function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("v-form",{ref:"form",attrs:{"lazy-validation":""}},[t("v-btn",{attrs:{color:"purple darken-3",outlined:"",tile:""},on:{click:function(a){e.isEditing=!e.isEditing}}},[e.isEditing?t("v-icon",{attrs:{left:""}},[e._v("mdi-close")]):t("v-icon",{attrs:{left:""}},[e._v("mdi-pencil")]),e._v("Edit\n    ")],1),e._v(" "),t("v-col",{staticClass:"d-flex flex-wrap justify-space-between py-5 px-0"},[e.isEditing&&e.userData.image?t("v-btn",{attrs:{disabled:e.isDisable,color:"error"},on:{click:e.remove}},[e._v("Remove")]):e._e(),e._v(" "),e.isEditing?t("v-btn",{attrs:{disabled:e.isDisable,color:"success"},on:{click:e.save}},[e._v("Save")]):e._e(),e._v(" "),e.hasCamera&&e.isEditing?t("v-btn",{attrs:{color:"cyan accent-2"},on:{click:function(a){return e.enableCamera()}}},[t("v-icon",[e._v("mdi-camera")])],1):e._e()],1),e._v(" "),e.success?t("v-alert",{attrs:{type:"success",dismissible:""}},[e._v("Your avatar has saved.")]):e._e(),e._v(" "),e.error?t("v-alert",{attrs:{type:"error",dismissible:""}},[e._v("Fill your data correctly.")]):e._e(),e._v(" "),t("v-snackbar",{attrs:{timeout:2e3,bottom:"",left:""},model:{value:e.success,callback:function(a){e.success=a},expression:"success"}},[e._v("Your avatar has been updated.")]),e._v(" "),t("v-snackbar",{attrs:{timeout:2e3,bottom:"",left:""},model:{value:e.error,callback:function(a){e.error=a},expression:"error"}},[e._v("Fill your data correctly.")]),e._v(" "),t("v-dialog",{attrs:{"max-width":"500px",eager:"",fullscreen:"",scrollable:""},model:{value:e.cameraDialog,callback:function(a){e.cameraDialog=a},expression:"cameraDialog"}},[t("v-card",{staticClass:"camera-dialog"},[t("v-card-text",{staticClass:"pa-0"},[t("div",{staticClass:"crop"},[t("video",{ref:"video",attrs:{autoplay:""}})]),e._v(" "),t("canvas",{ref:"canvas"})]),e._v(" "),t("v-card-actions",{staticClass:"d-flex flex-wrap justify-space-between"},[t("v-btn",{attrs:{color:"error"},on:{click:function(a){return e.disableCamera()}}},[e._v("Back")]),e._v(" "),t("v-btn",{attrs:{color:"primary"},on:{click:function(a){return e.capture()}}},[e._v("Take a photo")])],1)],1)],1),e._v(" "),t("v-file-input",{attrs:{rules:[e.rules.size],accept:"image/png, image/jpeg, image/webp",placeholder:"Pick an avatar",label:"Avatar","error-messages":e.errorFor("image_file"),"show-size":"",loading:e.loading,disabled:e.isDisable},on:{change:function(a){return e.previewImage(a,"userData")},"click:clear":function(a){return e.forceImageRerender()},input:function(a){return e.$emit("input",e.userData)}},model:{value:e.userData.image_file,callback:function(a){e.$set(e.userData,"image_file",a)},expression:"userData.image_file"}})],1)],1)}),[],!1,null,null,null);a.default=x.exports;d()(x,{VAlert:m.a,VBtn:f.a,VCard:g.a,VCardActions:p.a,VCardText:p.b,VCol:h.a,VDialog:b.a,VFileInput:_.a,VForm:D.a,VIcon:k.a,VSnackbar:w.a})}}]);
//# sourceMappingURL=0.chunk.js.map?id=3336ef9ba14f01b6c8ee